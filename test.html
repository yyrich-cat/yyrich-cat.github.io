<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        .button {
            background-color: blueviolet;
            border-radius: 25px;
            display: inline-block;
            color: cyan;
            padding: 5px 20px;
            cursor: pointer;
            transition-duration: .5s;
        }
        .button:hover {
            background-color: cyan;
            color: black;
        }
    </style>
</head>
<body>
    <div id="showInfo">
        <div id="wrap"></div>
    </div>
    <div class="button" id="bt">获取位置</div>
    <script>
        const showInfo = document.getElementById('showInfo');
        class geol {
            constructor (timeout, enableHighAccuracy = true) {
                this.options.timeout = timeout || this.options.timeout;
                this.options.enableHighAccuracy = enableHighAccuracy;
            }
            options = {
                enableHighAccuracy: true,
                timeout: 5000,
                maximumAge: 0
            }
            new_div (...innerText) {
                const div = document.createElement('div');
                const length = innerText.length;
                var text = '';
                for (let i = 0; i < length; i++) {
                    text += innerText[i];
                }
                div.innerText = text;
                return div;
            }
            success (pos) {
                console.log(Date.now()-this.startTime);
                const p = pos.coords;
                const df = new DocumentFragment()
                df.appendChild(this.new_div("维度：", p.latitude));
                df.appendChild(this.new_div("经度：", p.longitude));
                df.appendChild(this.new_div("海拔：", p.altitude));
                df.appendChild(this.new_div("精度：", p.accuracy, "米"));
                df.appendChild(this.new_div("更多信息：", JSON.stringify(pos)));
                const wp = document.createElement('div');
                wp.id = 'wrap';
                wp.appendChild(df);
                showInfo.replaceChild(wp,document.getElementById('wrap'));
            }
            error (err) {
                const wp = document.createElement('div');
                wp.id = 'wrap';
                wp.appendChild(this.new_div("遇到错误（", err.code, "）：", err.message));
                showInfo.replaceChild(wp,document.getElementById('wrap'));
            }
            get () {
                const geolocation = navigator.geolocation;
                if (geolocation) {
                    geolocation.getCurrentPosition((function (obj) {
                        return function (e){
                            obj.success(e);
                        }
                    })(this),(function (obj){
                        return function (e){
                            obj.error(e);
                        }
                    })(this),this.options)
                    this.startTime = Date.now();
                } else {
                    
                }
            }
        }
        function init () {
            document.getElementById('bt').onclick = function () {
                const g = new geol();
                g.get();
            }
        }
        init();
    </script>
</body>
</html>